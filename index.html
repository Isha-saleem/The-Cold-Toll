<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Cold Toll</title>
    <!-- Use Tailwind CDN for baseline utilities and custom CSS for game atmosphere -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Tone.js for simple audio effects -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.49/Tone.js"></script>
    <style>
        /* Using VT323 for a console/journal feel - very distinct and non-corporate */
        @import url('https://fonts.googleapis.com/css2?family=VT323&display=swap');
        
        :root {
            /* High-Contrast, Icy, and Warning Colors */
            --bg-color: #000000; /* Pure Black */
            --card-color: #0d0d1f; /* Near Black / Dark Indigo for background depth */
            --text-color: #e0f7fa; /* Icy White/Cyan */
            --highlight-color: #ff7043; /* Safety Red/Fire Orange */
            --hope-color: #4dd0e1; /* Neon Blue/Hope */
            --food-color: #81c784; /* Console Green */
            --wood-color: #ffb74d; /* Amber/Orange */
            --tools-color: #90a4ae; /* Cold Steel Gray */
        }

        body {
            font-family: 'VT323', monospace;
            background-color: var(--bg-color);
            color: var(--text-color);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
        }

        .screen-container {
            width: 100%;
            max-width: 600px;
            background-color: var(--card-color);
            border-radius: 4px; /* Sharper corners */
            box-shadow: 0 0 20px rgba(77, 208, 225, 0.2); /* Subtle blue glow */
            padding: 25px;
            border: 1px solid var(--hope-color);
            transition: opacity 0.5s;
        }

        /* --- Title Screen Specific Styles --- */
        #cover-screen {
            text-align: center;
            padding: 40px 20px;
            min-height: 400px;
        }

        #cover-screen h1 {
            font-size: 4rem;
            color: var(--hope-color);
            text-shadow: 0 0 10px var(--hope-color);
            letter-spacing: 5px;
            line-height: 1;
        }

        #cover-screen h2 {
            font-size: 1.5rem;
            color: var(--highlight-color);
            margin-bottom: 30px;
            letter-spacing: 3px;
        }
        
        /* --- General Game UI Styles --- */
        h1 {
            font-size: 2.5rem;
            color: var(--highlight-color);
            text-align: center;
            margin-bottom: 15px;
            text-shadow: 0 0 5px var(--highlight-color);
        }

        .stats-grid {
            border: 1px solid var(--tools-color);
            background: rgba(255, 255, 255, 0.05);
            border-radius: 2px;
            margin-bottom: 20px;
            box-shadow: 0 0 5px rgba(255, 255, 255, 0.1);
        }
        
        @media (max-width: 450px) {
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        .stat-item {
            padding: 5px 3px;
            border-right: 1px solid rgba(255, 255, 255, 0.1);
        }
        .stat-item:last-child {
             border-right: none;
        }

        .stat-label {
            font-size: 0.9rem;
            opacity: 0.7;
            letter-spacing: 1px;
        }

        .stat-value {
            font-size: 1.8rem;
            font-weight: normal;
        }

        #food-val { color: var(--food-color); }
        #wood-val { color: var(--wood-color); }
        #hope-val { color: var(--hope-color); }
        #tools-val { color: var(--tools-color); }
        
        .low-stat {
            animation: flicker-red 0.5s infinite alternate;
            background-color: rgba(255, 0, 0, 0.1);
        }

        @keyframes flicker-red {
            0% { box-shadow: 0 0 5px rgba(255, 112, 67, 0.6); }
            100% { box-shadow: 0 0 2px rgba(255, 112, 67, 0.3); }
        }

        #event-display {
            background-color: rgba(0, 0, 0, 0.5);
            border-radius: 4px;
            padding: 20px;
            margin-bottom: 20px;
            min-height: 140px;
            border-left: 5px solid var(--hope-color);
        }

        #event-title {
            font-size: 1.5rem;
            color: var(--wood-color);
            margin-bottom: 10px;
        }

        /* --- Console Log Button Styling --- */
        .choice-button {
            width: 100%;
            padding: 15px;
            margin: 8px 0;
            background-color: var(--card-color);
            color: var(--text-color);
            border: 1px solid var(--tools-color);
            border-radius: 2px;
            font-size: 1.1rem;
            letter-spacing: 1px;
            cursor: pointer;
            transition: background-color 0.1s, color 0.1s, box-shadow 0.1s;
        }

        .choice-button:hover {
            background-color: var(--hope-color);
            color: var(--bg-color);
            box-shadow: 0 0 10px var(--hope-color);
        }
        
        .choice-button:active {
            background-color: var(--highlight-color);
            color: var(--bg-color);
        }

        /* Modal Styles */
        #game-over-modal, #win-modal {
            background-color: rgba(0, 0, 0, 0.95);
        }

        .modal-content {
            background-color: var(--card-color);
            border: 3px solid var(--highlight-color);
            box-shadow: 0 0 25px var(--highlight-color);
            padding: 40px;
        }

        .modal-content h2 {
            font-size: 3rem;
            color: var(--highlight-color);
            text-shadow: 0 0 5px var(--highlight-color);
        }

        #reset-button {
            background-color: var(--hope-color);
            color: var(--bg-color);
            padding: 12px 25px;
            border: 1px solid var(--bg-color);
            font-size: 1.1rem;
            transition: background-color 0.2s;
            box-shadow: 0 0 8px var(--hope-color);
        }

        #reset-button:hover {
            background-color: var(--text-color);
        }
    </style>
</head>
<body>

    <!-- --- 1. COVER SCREEN (Initial View) --- -->
    <div class="screen-container" id="cover-screen">
        <h1>THE COLD TOLL</h1>
        <h2>A Log of Sacrifice</h2>
        
        <p class="text-xl mb-6">Genre: Survival Management / Narrative Choice</p>

        <div class="mb-8 p-4 border border-gray-700 rounded-sm text-left border-2 border-dashed border-red-500">
            <p>// Log Start</p>
            <p class="mt-2">You are the leader of a village trapped in an eternal winter.</p>
            <p class="mt-2">Manage **Food**, **Wood (Fuel)**, and **Hope (Morale)**. Every decision comes with a cost. Survive for **30 days** until the cold retreats!</p>
            <p class="mt-2">// Log End</p>
        </div>
        
        <button class="choice-button mt-4" onclick="loadGameUI()">START THE JOURNEY</button>
    </div>


    <!-- --- 2. MAIN GAME UI (Hidden until start) --- -->
    <div class="screen-container hidden" id="main-game-ui">
        <h1 id="game-title">THE COLD TOLL</h1>

        <!-- Day Tracker -->
        <p class="text-center text-xl mb-4">DAY <span id="day-val">1</span> / 30</p>

        <!-- Resource Stats -->
        <div class="stats-grid">
            <div class="stat-item" id="food-stat">
                <div class="stat-label">FOOD</div>
                <div class="stat-value" id="food-val">100</div>
            </div>
            <div class="stat-item" id="wood-stat">
                <div class="stat-label">WOOD</div>
                <div class="stat-value" id="wood-val">100</div>
            </div>
            <div class="stat-item" id="hope-stat">
                <div class="stat-label">HOPE</div>
                <div class="stat-value" id="hope-val">100</div>
            </div>
            <div class="stat-item" id="tools-stat">
                <div class="stat-label">TOOLS LVL</div>
                <div class="stat-value" id="tools-val">1</div>
            </div>
        </div>

        <!-- Event Display -->
        <div id="event-display">
            <p id="event-title">EVENT LOG</p>
            <p id="event-text">The village council waits for your first decree. The eternal winter has begun. You must make choices to survive.</p>
        </div>

        <!-- Choice Buttons -->
        <div id="choices-container">
            <button class="choice-button" id="choice-a-btn" onclick="handleChoice(0)">BEGIN THE FIRST DAY</button>
            <button class="choice-button" id="choice-b-btn" style="display:none;"></button>
        </div>
    </div>

    <!-- Game Over Modal -->
    <div id="game-over-modal">
        <div class="modal-content">
            <h2 id="game-over-title">FATAL ERROR</h2>
            <p class="text-xl my-4" id="game-over-reason">Reason for ending the game.</p>
            <p class="text-lg my-4">// RECORDED AT DAY <span id="final-day"></span></p>
            <button id="reset-button" onclick="loadGameUI()">REBOOT SYSTEM (RESTART)</button>
        </div>
    </div>
    
    <!-- Win Modal -->
    <div id="win-modal" style="display: none;">
        <div class="modal-content border-3 border-green-500">
            <h2 class="text-green-400" style="text-shadow: 0 0 8px #81c784;">INITIATION COMPLETE</h2>
            <p class="text-xl my-4">You survived **30 days** against the impossible cold. The sun is now visible on the horizon, and the sacrifices you made have saved the village.</p>
            <p class="text-lg my-4">// THAW REACHED AT DAY <span id="win-day">30</span></p>
            <button id="reset-button" onclick="loadGameUI()">REBOOT SYSTEM (PLAY AGAIN)</button>
        </div>
    </div>

    <script>
        // --- Tone.js Audio Engine ---
        let audioInitialized = false;
        let mainSynth;

        /**
         * Initializes the Tone.js audio context and synth. Must be called after a user gesture.
         */
        function initializeAudio() {
            if (audioInitialized) return;
            try {
                // Ensure Tone.js is running (required for modern browsers)
                Tone.start(); 
                
                // Use a simple polysynth for versatile tones
                mainSynth = new Tone.PolySynth(Tone.Synth, {
                    oscillator: { type: "sawtooth" },
                    envelope: { attack: 0.01, decay: 0.1, sustain: 0.2, release: 0.5 },
                }).toDestination();

                audioInitialized = true;
                console.log("Audio initialized.");
            } catch (e) {
                console.error("Audio failed to initialize:", e);
            }
        }

        /**
         * Plays a sound effect based on the type.
         * @param {string} type - 'success', 'loss', 'gameover', 'win', 'click'.
         */
        function playEffect(type) {
            if (!audioInitialized) {
                // Try to initialize on the first click if not already done
                initializeAudio();
                if (!audioInitialized) return;
            }

            switch (type) {
                case 'success':
                    mainSynth.triggerAttackRelease(["C5", "E5", "G5"], "8n");
                    break;
                case 'loss':
                    mainSynth.triggerAttackRelease(["C3", "Gb3"], "4n"); // Dissonant low chord
                    break;
                case 'gameover':
                    mainSynth.triggerAttackRelease("C2", "2n"); // Deep, long bass note
                    break;
                case 'win':
                    mainSynth.triggerAttackRelease(["F4", "A4", "C5"], "1n"); // Major chord, held long
                    break;
                case 'click':
                    mainSynth.triggerAttackRelease("G4", "16n");
                    break;
                default:
                    break;
            }
        }


        // --- Core Game State and Data ---
        let gameState = {};
        let currentEvent = null;
        const INITIAL_STATS = { food: 100, wood: 100, hope: 100, tools: 1, day: 1 };
        const LOW_THRESHOLD = 30; // Threshold for triggering low-resource warnings
        const WIN_DAY = 30; // The goal day

        const events = [
            // Standard Events (Day 1+)
            {
                title: "THE SICKLY ELDER",
                description: "An important elder, vital for maintaining order, has fallen gravely ill. The only medicine left could be turned into a Food supplement to feed three people for a day.",
                minDay: 1,
                choiceA: {
                    text: "GIVE ELDER MEDICINE. (HOPE +10, FOOD -5)",
                    effects: { hope: +10, food: -5, wood: 0, tools: 0 },
                    consequence: "The elder lives, reinforcing faith in the leadership, but the hungry must wait."
                },
                choiceB: {
                    text: "USE HERBS AS SUPPLEMENT. (HOPE -15, FOOD +3)",
                    effects: { hope: -15, food: +3, wood: 0, tools: 0 },
                    consequence: "The elder passes, but others eat. Morale drops."
                }
            },
            {
                title: "FUEL SCARCITY",
                description: "The wood stores are critically low. To last the night, you must burn material from a community structure. Do you sacrifice the public library or the only existing toolshed?",
                minDay: 1,
                choiceA: {
                    text: "BURN THE LIBRARY. (WOOD +25, HOPE -10)",
                    effects: { wood: +25, hope: -10, food: 0, tools: 0 },
                    consequence: "Warmth is secured, but knowledge is lost forever."
                },
                choiceB: {
                    text: "BURN THE TOOLSHED. (WOOD +20, HOPE +5, FOOD -10)",
                    effects: { wood: +20, hope: +5, food: -10, tools: 0 },
                    consequence: "Tools are gone; future resource gathering will be temporarily harder."
                }
            },
            {
                title: "THE DESERTER",
                description: "A strong young member was caught trying to sneak out with a large bundle of reserves. Public punishment improves discipline. Mercy is seen as weakness.",
                minDay: 1,
                choiceA: {
                    text: "PUNISH PUBLICLY. (HOPE +15, FOOD +5, WOOD +5)",
                    effects: { food: +5, wood: +5, hope: +15, tools: 0 },
                    consequence: "The reserves are saved and order is maintained, but fear permeates."
                },
                choiceB: {
                    text: "EXILE THEM. (HOPE -5)",
                    effects: { food: +0, wood: +0, hope: -5, tools: 0 },
                    consequence: "The community questions the fairness of the law."
                }
            },
            {
                title: "A HIDDEN CACHE",
                description: "A scavenger team reports finding an unmarked, hidden ice cellar. It's risky to open, but could contain resources.",
                minDay: 1,
                choiceA: {
                    text: "OPEN THE CACHE. (FOOD +20, WOOD +20, HOPE -5)", 
                    effects: { food: +20, wood: +20, hope: -5, tools: 0 }, 
                    consequence: "The team returns with a surprisingly large haul! Spirits lift slightly despite the danger."
                },
                choiceB: {
                    text: "LEAVE IT ALONE. TOO DANGEROUS. (HOPE +5)",
                    effects: { food: +0, wood: +0, hope: +5, tools: 0 },
                    consequence: "Safety is secured. The team returns safe, and the mystery remains."
                }
            },
            {
                title: "TOOL SALVAGE OPPORTUNITY",
                description: "A frozen blacksmith's shop was discovered. It holds enough raw steel to either repair your current tools or craft a small stockpile of hope-giving jewelry.",
                minDay: 5,
                choiceA: {
                    text: "UPGRADE TOOLS. (TOOLS +1, FOOD -10, WOOD -10)",
                    effects: { food: -10, wood: -10, hope: +5, tools: +1 },
                    consequence: "The village has better, stronger tools! Future daily resource consumption is slightly reduced."
                },
                choiceB: {
                    text: "CRAFT JEWELRY. (HOPE +30)",
                    effects: { food: +0, wood: +0, hope: +30, tools: 0 },
                    consequence: "The jewelry provides a much-needed boost to morale, reminding the villagers of life before the cold."
                }
            },
            // New High-Stakes and Crisis Events (Day 10+)
            {
                title: "THE BLIGHT",
                description: "A fungal blight has struck the Food stores. You can burn Wood to dry and save some, or you can cut your losses and discard the spoiled portion.",
                minDay: 10,
                choiceA: {
                    text: "BURN WOOD TO SAVE FOOD. (FOOD -10, WOOD -25)",
                    effects: { food: -10, wood: -25, hope: 0, tools: 0 },
                    consequence: "A small portion is saved. You avoided a total Food crisis, but fuel is now critical."
                },
                choiceB: {
                    text: "DISCARD SPOILED FOOD. (FOOD -25, HOPE -5)",
                    effects: { food: -25, wood: 0, hope: -5, tools: 0 },
                    consequence: "The Food loss is severe, and the mood darkens."
                }
            },
            {
                title: "THE ICE QUAKE",
                description: "A deep tremor shakes the ground. A crucial part of your Wood stock is now trapped under thick ice. You can spend Hope rallying a team to retrieve it, or let the wood go.",
                minDay: 10,
                choiceA: {
                    text: "RALLY TEAM TO RETRIEVE WOOD. (HOPE -15, WOOD +20)",
                    effects: { wood: +20, hope: -15, food: 0, tools: 0 },
                    consequence: "The team succeeds! Hope took a hit, but the fuel reserves are replenished."
                },
                choiceB: {
                    text: "LET THE WOOD GO. (WOOD -10, HOPE +0)",
                    effects: { wood: -10, hope: +0, food: 0, tools: 0 },
                    consequence: "You conserve Hope but suffer a painful loss to your Wood reserves."
                }
            },
            {
                title: "PRE-THAW FRENZY",
                description: "The air temperature has inexplicably risen by a degree. Villagers, sensing the cold might break soon, are celebrating prematurely, wasting supplies and neglecting duties.",
                minDay: 20, // Only appears late in the game
                choiceA: {
                    text: "IMPOSE CURFEW/RATIONING. (HOPE -20, FOOD +5, WOOD +5)",
                    effects: { wood: +5, food: +5, hope: -20, tools: 0 },
                    consequence: "Rationing halts the waste, but the severe clampdown crushes the villagers' fragile dreams."
                },
                choiceB: {
                    text: "LET THEM CELEBRATE. (HOPE +15, FOOD -15, WOOD -15)",
                    effects: { wood: -15, food: -15, hope: +15, tools: 0 },
                    consequence: "The village has a moment of joy, but the cost in reserves is severe."
                }
            }
        ];

        // --- Utility Functions ---

        /**
         * Safely clamps a value between a min (0) and max (100) for Food, Wood, and Hope.
         * Tools are clamped between 1 and 3 (Level 3 max).
         * @param {string} statKey - The name of the stat.
         * @param {number} value - The new value.
         * @returns {number} The clamped value.
         */
        function clampStat(statKey, value) {
            if (statKey === 'tools') {
                return Math.max(1, Math.min(3, value)); // Max tool level is 3
            }
            return Math.max(0, Math.min(100, value));
        }

        /**
         * Hides the cover screen and shows the main game UI.
         */
        function loadGameUI() {
            initializeAudio(); // Initialize audio here since the user clicked "Start The Journey"
            document.getElementById('cover-screen').classList.add('hidden');
            document.getElementById('main-game-ui').classList.remove('hidden');
            document.getElementById('win-modal').style.display = 'none';
            document.getElementById('game-over-modal').style.display = 'none';
            startGame();
        }

        /**
         * Initializes the game state and sets up the first event in the main UI.
         */
        function startGame() {
            gameState = { ...INITIAL_STATS };
            
            // Set up the initial screen/prompt
            currentEvent = {
                title: "THE SILENCE",
                description: "The village council waits for your first decree. The eternal winter has begun. You must make choices to survive.",
                minDay: 1,
                choiceA: { text: "ACCEPT THE BURDEN.", effects: { food: 0, wood: 0, hope: 0, tools: 0 } },
                choiceB: { text: "", effects: { food: 0, wood: 0, hope: 0, tools: 0 } }
            };
            
            updateUI();
            
            // Setup the starting button to transition to the first real day
            const startBtn = document.getElementById('choices-container').querySelector('#choice-a-btn');
            startBtn.onclick = () => { playEffect('click'); nextDay(); };
            startBtn.textContent = "ACCEPT THE BURDEN (START DAY 1)";
            
            const choiceB = document.getElementById('choices-container').querySelector('#choice-b-btn');
            if (choiceB) {
                choiceB.style.display = 'none';
            }
        }

        /**
         * Updates the resource consumption and selects a new event.
         */
        function nextDay() {
            // Check for Win Condition BEFORE daily consumption
            if (gameState.day >= WIN_DAY) {
                gameWin();
                return;
            }

            // Apply daily consumption. Tools level reduces consumption.
            const baseConsumption = 6;
            // Tool Efficiency: Lvl 1 (0 bonus), Lvl 2 (1 bonus), Lvl 3 (2 bonus). Max consumption reduction is 2.
            const toolEfficiencyBonus = (gameState.tools - 1); 

            gameState.day++;
            
            // Consumption is reduced by tool level
            gameState.food -= Math.floor(baseConsumption + Math.random() * 3) - toolEfficiencyBonus; 
            gameState.wood -= Math.floor(baseConsumption + Math.random() * 3) - toolEfficiencyBonus; 
            gameState.hope -= Math.floor(1 + Math.random() * 2); 

            // Clamp stats after consumption
            gameState.food = clampStat('food', gameState.food);
            gameState.wood = clampStat('wood', gameState.wood);
            gameState.hope = clampStat('hope', gameState.hope);
            gameState.tools = clampStat('tools', gameState.tools); 

            // Check for game over
            if (checkGameOver()) return;
            
            // Filter events to only include those available at the current day
            const availableEvents = events.filter(e => gameState.day >= e.minDay);

            // Select and display new random event from available pool
            const randomEventIndex = Math.floor(Math.random() * availableEvents.length);
            currentEvent = availableEvents[randomEventIndex];
            
            updateUI();
        }

        /**
         * Applies the consequences of the player's choice.
         * @param {number} choiceIndex - 0 for A, 1 for B.
         */
        function handleChoice(choiceIndex) {
            const choice = choiceIndex === 0 ? currentEvent.choiceA : currentEvent.choiceB;
            
            // Calculate net resource change to determine success/loss sound
            let netChange = 0;
            netChange += (choice.effects.food / 10); // Food is worth more
            netChange += (choice.effects.wood / 10);
            netChange += (choice.effects.hope / 10);
            netChange += (choice.effects.tools * 20); // Tool upgrades are a major positive

            if (netChange > 5) {
                playEffect('success');
            } else if (netChange < -5) {
                playEffect('loss');
            } else {
                playEffect('click');
            }

            // Apply effects
            gameState.food += choice.effects.food;
            gameState.wood += choice.effects.wood;
            gameState.hope += choice.effects.hope;
            gameState.tools += choice.effects.tools;

            // Clamp stats after effects
            gameState.food = clampStat('food', gameState.food);
            gameState.wood = clampStat('wood', gameState.wood);
            gameState.hope = clampStat('hope', gameState.hope);
            gameState.tools = clampStat('tools', gameState.tools);
            
            // Display consequence message before moving to the next day
            document.getElementById('event-title').textContent = "CONSEQUENCE LOGGED";
            document.getElementById('event-text').textContent = choice.consequence || "The choice is made. The people look to the next sunrise.";

            // Temporarily disable buttons and show only the continue button
            document.getElementById('choices-container').innerHTML = `
                <button class="choice-button" onclick="nextDay()">CONTINUE TO DAY ${gameState.day}</button>
            `;

            // Check for game over *after* the choice has been applied
            checkGameOver();
        }

        /**
         * Updates the HTML elements with the current game state.
         */
        function updateUI() {
            // Update day tracker
            document.getElementById('day-val').textContent = gameState.day;
            
            // Update resources and check for low stats
            const stats = ['food', 'wood', 'hope', 'tools'];
            stats.forEach(stat => {
                const valueEl = document.getElementById(`${stat}-val`);
                const statEl = document.getElementById(`${stat}-stat`);
                valueEl.textContent = gameState[stat];

                // Add pulse animation for low resources (only for Food, Wood, Hope)
                if (stat !== 'tools' && gameState[stat] <= LOW_THRESHOLD) {
                    statEl.classList.add('low-stat');
                } else {
                    statEl.classList.remove('low-stat');
                }
            });

            // Update event
            document.getElementById('event-title').textContent = currentEvent.title;
            document.getElementById('event-text').textContent = currentEvent.description;

            // Update choices
            const container = document.getElementById('choices-container');
            if (currentEvent.choiceB.text) {
                // Display both choices
                container.innerHTML = `
                    <button class="choice-button" id="choice-a-btn" onclick="handleChoice(0)">${currentEvent.choiceA.text}</button>
                    <button class="choice-button" id="choice-b-btn" onclick="handleChoice(1)">${currentEvent.choiceB.text}</button>
                `;
            } else {
                 // Display only choice A (for starting the game or continue)
                container.innerHTML = `
                    <button class="choice-button" id="choice-a-btn" onclick="handleChoice(0)">${currentEvent.choiceA.text}</button>
                `;
            }
        }

        /**
         * Checks for game-ending conditions and calls gameOver if necessary.
         * @returns {boolean} True if the game is over.
         */
        function checkGameOver() {
            let reason = null;

            if (gameState.food <= 0) {
                reason = "FOOD STORES CRITICAL. THE VILLAGE IS STARVING.";
            } else if (gameState.wood <= 0) {
                reason = "FUEL DEPLETED. THE FIRES ARE OUT. DEATH BY COLD.";
            } else if (gameState.hope <= 0) {
                reason = "MORALE ZERO. ALL WORK HAS CEASED. THE VILLAGE GIVES UP.";
            }
            
            if (reason) {
                gameOver(reason);
                return true;
            }
            return false;
        }

        /**
         * Displays the game over screen (Loss).
         * @param {string} reason - The reason the game ended.
         */
        function gameOver(reason) {
            playEffect('gameover');
            document.getElementById('game-over-title').textContent = "FATAL ERROR";
            document.getElementById('game-over-reason').textContent = reason;
            document.getElementById('final-day').textContent = gameState.day;
            document.getElementById('game-over-modal').style.display = 'flex';
            document.getElementById('main-game-ui').classList.add('hidden');
        }

        /**
         * Displays the game win screen.
         */
        function gameWin() {
            playEffect('win');
            document.getElementById('win-day').textContent = WIN_DAY;
            document.getElementById('win-modal').style.display = 'flex';
            document.getElementById('main-game-ui').classList.add('hidden');
        }

        // Initialize the game on page load by showing the cover screen
        window.onload = function() {
            document.getElementById('main-game-ui').classList.add('hidden');
        };

    </script>
</body>
</html>
